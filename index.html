<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gold & Silver Price (Nepal)</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#d4af37">

<style>
body {
  font-family: system-ui, sans-serif;
  background: #f4f4f4;
  margin: 0;
  padding: 16px;
}
.card {
  background: #fff;
  padding: 16px;
  margin-bottom: 16px;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,.08);
}
h1,h2 { margin-top: 0; }
.price {
  font-size: 22px;
  font-weight: bold;
  margin-top: 8px;
}
.note {
  font-size: 13px;
  color: #666;
}
</style>
</head>

<body>

<h1>Gold & Silver Price (Nepal ðŸ‡³ðŸ‡µ)</h1>

<div class="card">
<h2>Gold (per tola)</h2>
<div class="price" id="goldPrice">Loadingâ€¦</div>
</div>

<div class="card">
<h2>Silver (per tola)</h2>
<div class="price" id="silverPrice">Loadingâ€¦</div>
</div>

<p class="note">
Prices are estimated from international market rates and converted to NPR.
</p>

<script>
const GOLD_API = "https://www.goldapi.io/api/XAU/USD";
const SILVER_API = "https://www.goldapi.io/api/XAG/USD";
const API_KEY = "YOUR_GOLDAPI_KEY";

const USD_TO_NPR = 133.5; // auto-update manually if needed

const TROY_OUNCE_TO_GRAM = 31.1034768;
const TOLA_TO_GRAM = 11.6638;

async function fetchMetalPrice(url) {
  const res = await fetch(url, {
    headers: { "x-access-token": API_KEY }
  });
  const data = await res.json();
  return data.price;
}

async function updatePrices() {
  try {
    const goldUsdOz = await fetchMetalPrice(GOLD_API);
    const silverUsdOz = await fetchMetalPrice(SILVER_API);

    const goldUsdTola =
      (goldUsdOz / TROY_OUNCE_TO_GRAM) * TOLA_TO_GRAM;
    const silverUsdTola =
      (silverUsdOz / TROY_OUNCE_TO_GRAM) * TOLA_TO_GRAM;

    const goldNpr = goldUsdTola * USD_TO_NPR;
    const silverNpr = silverUsdTola * USD_TO_NPR;

    document.getElementById("goldPrice").innerText =
      `NPR ${goldNpr.toFixed(0)}`;

    document.getElementById("silverPrice").innerText =
      `NPR ${silverNpr.toFixed(0)}`;

  } catch (e) {
    document.getElementById("goldPrice").innerText = "Error loading data";
    document.getElementById("silverPrice").innerText = "Error loading data";
  }
}

updatePrices();
setInterval(updatePrices, 10 * 60 * 1000); // refresh every 10 min

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
