<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gold & Silver Price (Nepal)</title>

<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#d4af37"/>

<style>
body {
  font-family: system-ui, sans-serif;
  background: #f5f5f5;
  margin: 0;
  padding: 16px;
}
.card {
  background: white;
  padding: 16px;
  margin-bottom: 16px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,.08);
}
h1, h2 {
  margin-top: 0;
}
label {
  display: block;
  margin-top: 10px;
  font-weight: 600;
}
input {
  width: 100%;
  padding: 8px;
  margin-top: 4px;
}
.price {
  font-size: 20px;
  font-weight: bold;
  margin-top: 10px;
}
.note {
  font-size: 13px;
  color: #666;
}
</style>
</head>

<body>

<h1>Gold & Silver Price (Nepal ðŸ‡³ðŸ‡µ)</h1>

<div class="card">
<h2>Exchange Rate</h2>
<label>USD â†’ NPR</label>
<input type="number" id="usdRate" value="133.5" />
</div>

<div class="card">
<h2>Gold</h2>
<div class="price" id="goldEstimate">Loadingâ€¦</div>

<label>Manual Nepal Gold Price (NPR / tola)</label>
<input type="number" id="goldManual" placeholder="e.g. 165000" />
<div class="price" id="goldNepal"></div>

<p class="note">
Estimated price is calculated from international market.  
Manual price reflects Nepal market rate.
</p>
</div>

<div class="card">
<h2>Silver</h2>
<div class="price" id="silverEstimate">Loadingâ€¦</div>

<label>Manual Nepal Silver Price (NPR / tola)</label>
<input type="number" id="silverManual" placeholder="e.g. 2000" />
<div class="price" id="silverNepal"></div>
</div>

<script>
const GOLD_API = "https://www.goldapi.io/api/XAU/USD";
const SILVER_API = "https://www.goldapi.io/api/XAG/USD";
const API_KEY = "YOUR_API_KEY_HERE";

const TROY_OUNCE_TO_GRAM = 31.1034768;
const TOLA_TO_GRAM = 11.6638;

async function fetchPrice(url) {
  const res = await fetch(url, {
    headers: { "x-access-token": API_KEY }
  });
  const data = await res.json();
  return data.price;
}

async function updatePrices() {
  const usdRate = parseFloat(document.getElementById("usdRate").value);

  const goldUsdOz = await fetchPrice(GOLD_API);
  const silverUsdOz = await fetchPrice(SILVER_API);

  const goldUsdTola =
    (goldUsdOz / TROY_OUNCE_TO_GRAM) * TOLA_TO_GRAM;
  const silverUsdTola =
    (silverUsdOz / TROY_OUNCE_TO_GRAM) * TOLA_TO_GRAM;

  const goldNprEstimate = goldUsdTola * usdRate;
  const silverNprEstimate = silverUsdTola * usdRate;

  document.getElementById("goldEstimate").innerText =
    `Estimated: NPR ${goldNprEstimate.toFixed(0)} / tola`;

  document.getElementById("silverEstimate").innerText =
    `Estimated: NPR ${silverNprEstimate.toFixed(0)} / tola`;
}

document.getElementById("goldManual").addEventListener("input", e => {
  document.getElementById("goldNepal").innerText =
    e.target.value
      ? `Nepal Market: NPR ${e.target.value} / tola`
      : "";
});

document.getElementById("silverManual").addEventListener("input", e => {
  document.getElementById("silverNepal").innerText =
    e.target.value
      ? `Nepal Market: NPR ${e.target.value} / tola`
      : "";
});

updatePrices();

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
